<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard Resultados Acumulados 2025 - MRS Log√≠stica</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        :root {
  /* Primitive Color Tokens */
  --color-white: rgba(255, 255, 255, 1);
  --color-black: rgba(0, 0, 0, 1);
  --color-cream-50: rgba(252, 252, 249, 1);
  --color-cream-100: rgba(255, 255, 253, 1);
  --color-gray-200: rgba(245, 245, 245, 1);
  --color-gray-300: rgba(167, 169, 169, 1);
  --color-gray-400: rgba(119, 124, 124, 1);
  --color-slate-500: rgba(98, 108, 113, 1);
  --color-brown-600: rgba(94, 82, 64, 1);
  --color-charcoal-700: rgba(31, 33, 33, 1);
  --color-charcoal-800: rgba(38, 40, 40, 1);
  --color-slate-900: rgba(19, 52, 59, 1);
  --color-teal-300: rgba(50, 184, 198, 1);
  --color-teal-400: rgba(45, 166, 178, 1);
  --color-teal-500: rgba(33, 128, 141, 1);
  --color-teal-600: rgba(29, 116, 128, 1);
  --color-teal-700: rgba(26, 104, 115, 1);
  --color-teal-800: rgba(41, 150, 161, 1);
  --color-red-400: rgba(255, 84, 89, 1);
  --color-red-500: rgba(192, 21, 47, 1);
  --color-orange-400: rgba(230, 129, 97, 1);
  --color-orange-500: rgba(168, 75, 47, 1);

  /* RGB versions for opacity control */
  --color-brown-600-rgb: 94, 82, 64;
  --color-teal-500-rgb: 33, 128, 141;
  --color-slate-900-rgb: 19, 52, 59;
  --color-slate-500-rgb: 98, 108, 113;
  --color-red-500-rgb: 192, 21, 47;
  --color-red-400-rgb: 255, 84, 89;
  --color-orange-500-rgb: 168, 75, 47;
  --color-orange-400-rgb: 230, 129, 97;

  /* Background color tokens (Light Mode) */
  --color-bg-1: rgba(59, 130, 246, 0.08);
  --color-bg-2: rgba(245, 158, 11, 0.08);
  --color-bg-3: rgba(34, 197, 94, 0.08);
  --color-bg-4: rgba(239, 68, 68, 0.08);
  --color-bg-5: rgba(147, 51, 234, 0.08);
  --color-bg-6: rgba(249, 115, 22, 0.08);
  --color-bg-7: rgba(236, 72, 153, 0.08);
  --color-bg-8: rgba(6, 182, 212, 0.08);

  /* Semantic Color Tokens (Light Mode) */
  --color-background: var(--color-cream-50);
  --color-surface: var(--color-cream-100);
  --color-text: var(--color-slate-900);
  --color-text-secondary: var(--color-slate-500);
  --color-primary: var(--color-teal-500);
  --color-primary-hover: var(--color-teal-600);
  --color-primary-active: var(--color-teal-700);
  --color-secondary: rgba(var(--color-brown-600-rgb), 0.12);
  --color-secondary-hover: rgba(var(--color-brown-600-rgb), 0.2);
  --color-secondary-active: rgba(var(--color-brown-600-rgb), 0.25);
  --color-border: rgba(var(--color-brown-600-rgb), 0.2);
  --color-btn-primary-text: var(--color-cream-50);
  --color-card-border: rgba(var(--color-brown-600-rgb), 0.12);
  --color-card-border-inner: rgba(var(--color-brown-600-rgb), 0.12);
  --color-error: var(--color-red-500);
  --color-success: var(--color-teal-500);
  --color-warning: var(--color-orange-500);
  --color-info: var(--color-slate-500);
  --color-focus-ring: rgba(var(--color-teal-500-rgb), 0.4);
  --color-select-caret: rgba(var(--color-slate-900-rgb), 0.8);

  /* Typography */
  --font-family-base: "FKGroteskNeue", "Geist", "Inter", -apple-system,
    BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
  --font-size-xs: 11px;
  --font-size-sm: 12px;
  --font-size-base: 14px;
  --font-size-md: 14px;
  --font-size-lg: 16px;
  --font-size-xl: 18px;
  --font-size-2xl: 20px;
  --font-size-3xl: 24px;
  --font-size-4xl: 30px;
  --font-weight-normal: 400;
  --font-weight-medium: 500;
  --font-weight-semibold: 550;
  --font-weight-bold: 600;
  --line-height-tight: 1.2;
  --line-height-normal: 1.5;

  /* Spacing */
  --space-8: 8px;
  --space-12: 12px;
  --space-16: 16px;
  --space-20: 20px;
  --space-24: 24px;
  --space-32: 32px;

  /* Border Radius */
  --radius-base: 8px;
  --radius-md: 10px;
  --radius-lg: 12px;

  /* Shadows */
  --shadow-sm: 0 1px 3px rgba(0, 0, 0, 0.04), 0 1px 2px rgba(0, 0, 0, 0.02);
  --shadow-md: 0 4px 6px -1px rgba(0, 0, 0, 0.04), 0 2px 4px -1px rgba(0, 0, 0, 0.02);

  /* Animation */
  --duration-fast: 150ms;
  --duration-normal: 250ms;
  --ease-standard: cubic-bezier(0.16, 1, 0.3, 1);
}

/* Dark mode colors */
@media (prefers-color-scheme: dark) {
  :root {
    --color-gray-400-rgb: 119, 124, 124;
    --color-teal-300-rgb: 50, 184, 198;
    --color-gray-300-rgb: 167, 169, 169;
    --color-gray-200-rgb: 245, 245, 245;

    --color-bg-1: rgba(29, 78, 216, 0.15);
    --color-bg-2: rgba(180, 83, 9, 0.15);
    --color-bg-3: rgba(21, 128, 61, 0.15);
    --color-bg-4: rgba(185, 28, 28, 0.15);
    --color-bg-5: rgba(107, 33, 168, 0.15);
    --color-bg-6: rgba(194, 65, 12, 0.15);
    --color-bg-7: rgba(190, 24, 93, 0.15);
    --color-bg-8: rgba(8, 145, 178, 0.15);

    --color-background: var(--color-charcoal-700);
    --color-surface: var(--color-charcoal-800);
    --color-text: var(--color-gray-200);
    --color-text-secondary: rgba(var(--color-gray-300-rgb), 0.7);
    --color-primary: var(--color-teal-300);
    --color-primary-hover: var(--color-teal-400);
    --color-primary-active: var(--color-teal-800);
    --color-secondary: rgba(var(--color-gray-400-rgb), 0.15);
    --color-secondary-hover: rgba(var(--color-gray-400-rgb), 0.25);
    --color-secondary-active: rgba(var(--color-gray-400-rgb), 0.3);
    --color-border: rgba(var(--color-gray-400-rgb), 0.3);
    --color-error: var(--color-red-400);
    --color-success: var(--color-teal-300);
    --color-warning: var(--color-orange-400);
    --color-info: var(--color-gray-300);
    --color-focus-ring: rgba(var(--color-teal-300-rgb), 0.4);
    --color-btn-primary-text: var(--color-slate-900);
    --color-card-border: rgba(var(--color-gray-400-rgb), 0.2);
    --color-card-border-inner: rgba(var(--color-gray-400-rgb), 0.15);
  }
}

[data-color-scheme="dark"] {
    --color-gray-400-rgb: 119, 124, 124;
    --color-teal-300-rgb: 50, 184, 198;
    --color-gray-300-rgb: 167, 169, 169;
    --color-gray-200-rgb: 245, 245, 245;

    --color-bg-1: rgba(29, 78, 216, 0.15);
    --color-bg-2: rgba(180, 83, 9, 0.15);
    --color-bg-3: rgba(21, 128, 61, 0.15);
    --color-bg-4: rgba(185, 28, 28, 0.15);
    --color-bg-5: rgba(107, 33, 168, 0.15);
    --color-bg-6: rgba(194, 65, 12, 0.15);
    --color-bg-7: rgba(190, 24, 93, 0.15);
    --color-bg-8: rgba(8, 145, 178, 0.15);

    --color-background: var(--color-charcoal-700);
    --color-surface: var(--color-charcoal-800);
    --color-text: var(--color-gray-200);
    --color-text-secondary: rgba(var(--color-gray-300-rgb), 0.7);
    --color-primary: var(--color-teal-300);
    --color-primary-hover: var(--color-teal-400);
    --color-primary-active: var(--color-teal-800);
    --color-secondary: rgba(var(--color-gray-400-rgb), 0.15);
    --color-secondary-hover: rgba(var(--color-gray-400-rgb), 0.25);
    --color-secondary-active: rgba(var(--color-gray-400-rgb), 0.3);
    --color-border: rgba(var(--color-gray-400-rgb), 0.3);
    --color-error: var(--color-red-400);
    --color-success: var(--color-teal-300);
    --color-warning: var(--color-orange-400);
    --color-info: var(--color-gray-300);
    --color-focus-ring: rgba(var(--color-teal-300-rgb), 0.4);
    --color-btn-primary-text: var(--color-slate-900);
    --color-card-border: rgba(var(--color-gray-400-rgb), 0.2);
    --color-card-border-inner: rgba(var(--color-gray-400-rgb), 0.15);
}

@font-face {
  font-family: 'FKGroteskNeue';
  src: url('https://r2cdn.perplexity.ai/fonts/FKGroteskNeue.woff2') format('woff2');
}

* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
}

body {
    font-family: var(--font-family-base);
    background-color: var(--color-background);
    color: var(--color-text);
    line-height: var(--line-height-normal);
    transition: background-color var(--duration-normal) var(--ease-standard),
                color var(--duration-normal) var(--ease-standard);
}

.dashboard {
    min-height: 100vh;
    padding: var(--space-24);
}

.header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: var(--space-32);
    padding-bottom: var(--space-24);
    border-bottom: 1px solid var(--color-border);
}

.header-content h1 {
    font-size: var(--font-size-4xl);
    font-weight: var(--font-weight-bold);
    color: var(--color-text);
    margin-bottom: var(--space-8);
}

.header-subtitle {
    font-size: var(--font-size-lg);
    color: var(--color-text-secondary);
    margin: 0;
    margin-bottom: var(--space-8);
}

.header-date {
    font-size: var(--font-size-sm);
    color: var(--color-text-secondary);
    font-weight: var(--font-weight-medium);
    margin: 0;
}

.header-actions {
    display: flex;
    gap: var(--space-12);
    align-items: center;
}

.btn-export {
    background: var(--color-primary);
    color: var(--color-btn-primary-text);
    border: none;
    border-radius: var(--radius-base);
    padding: var(--space-12) var(--space-20);
    cursor: pointer;
    font-size: var(--font-size-base);
    font-weight: var(--font-weight-medium);
    transition: all var(--duration-normal) var(--ease-standard);
}

.btn-export:hover {
    background: var(--color-primary-hover);
    transform: translateY(-1px);
}

.theme-toggle {
    background: var(--color-secondary);
    border: 1px solid var(--color-border);
    border-radius: var(--radius-base);
    padding: var(--space-12) var(--space-20);
    cursor: pointer;
    font-size: var(--font-size-base);
    font-weight: var(--font-weight-medium);
    color: var(--color-text);
    transition: all var(--duration-normal) var(--ease-standard);
}

.theme-toggle:hover {
    background: var(--color-secondary-hover);
}

.kpi-cards {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
    gap: var(--space-20);
    margin-bottom: var(--space-32);
}

.kpi-card {
    background: var(--color-surface);
    border: 1px solid var(--color-card-border);
    border-radius: var(--radius-lg);
    padding: var(--space-24);
    box-shadow: var(--shadow-sm);
    transition: all var(--duration-normal) var(--ease-standard);
    animation: fadeInUp 0.5s var(--ease-standard) forwards;
    opacity: 0;
}

.kpi-card:nth-child(1) { animation-delay: 0.1s; }
.kpi-card:nth-child(2) { animation-delay: 0.2s; }
.kpi-card:nth-child(3) { animation-delay: 0.3s; }
.kpi-card:nth-child(4) { animation-delay: 0.4s; }

.kpi-card:hover {
    transform: translateY(-2px);
    box-shadow: var(--shadow-md);
}

.kpi-icon {
    width: 48px;
    height: 48px;
    border-radius: var(--radius-base);
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 24px;
    margin-bottom: var(--space-16);
}

.kpi-card:nth-child(1) .kpi-icon { background: var(--color-bg-1); }
.kpi-card:nth-child(2) .kpi-icon { background: var(--color-bg-2); }
.kpi-card:nth-child(3) .kpi-icon { background: var(--color-bg-3); }
.kpi-card:nth-child(4) .kpi-icon { background: var(--color-bg-4); }

.kpi-value {
    font-size: var(--font-size-4xl);
    font-weight: var(--font-weight-bold);
    color: var(--color-text);
    margin-bottom: var(--space-8);
}

.kpi-label {
    font-size: var(--font-size-base);
    color: var(--color-text-secondary);
    font-weight: var(--font-weight-medium);
}

.charts-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(500px, 1fr));
    gap: var(--space-24);
    margin-bottom: var(--space-32);
}

.chart-card {
    background: var(--color-surface);
    border: 1px solid var(--color-card-border);
    border-radius: var(--radius-lg);
    padding: var(--space-24);
    box-shadow: var(--shadow-sm);
    animation: fadeInUp 0.6s var(--ease-standard) forwards;
    opacity: 0;
}

.chart-card:nth-child(1) { animation-delay: 0.5s; }
.chart-card:nth-child(2) { animation-delay: 0.6s; }
.chart-card:nth-child(3) { animation-delay: 0.7s; }
.chart-card:nth-child(4) { animation-delay: 0.8s; }
.chart-card:nth-child(5) { animation-delay: 0.9s; }
.chart-card:nth-child(6) { animation-delay: 1s; }

.chart-header {
    margin-bottom: var(--space-20);
}

.chart-title {
    font-size: var(--font-size-xl);
    font-weight: var(--font-weight-semibold);
    color: var(--color-text);
    margin-bottom: var(--space-8);
}

.chart-subtitle {
    font-size: var(--font-size-sm);
    color: var(--color-text-secondary);
}

.chart-container {
    position: relative;
    height: 300px;
}

.financial-cards {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: var(--space-16);
}

.financial-card {
    background: var(--color-bg-1);
    border: 1px solid var(--color-card-border);
    border-radius: var(--radius-md);
    padding: var(--space-20);
}

.financial-card:nth-child(2) { background: var(--color-bg-2); }
.financial-card:nth-child(3) { background: var(--color-bg-3); }

.financial-icon {
    font-size: 24px;
    margin-bottom: var(--space-12);
}

.financial-value {
    font-size: var(--font-size-xl);
    font-weight: var(--font-weight-bold);
    color: var(--color-text);
    margin-bottom: var(--space-8);
    word-break: break-all;
}

.financial-label {
    font-size: var(--font-size-sm);
    color: var(--color-text-secondary);
    font-weight: var(--font-weight-medium);
}

.footer {
    margin-top: var(--space-32);
    padding-top: var(--space-24);
    border-top: 1px solid var(--color-border);
    display: flex;
    justify-content: space-between;
    align-items: center;
    flex-wrap: wrap;
    gap: var(--space-16);
}

.footer-info {
    font-size: var(--font-size-sm);
    color: var(--color-text-secondary);
}

.footer-brand {
    font-size: var(--font-size-lg);
    font-weight: var(--font-weight-bold);
    color: var(--color-primary);
}

@keyframes fadeInUp {
    from {
        opacity: 0;
        transform: translateY(20px);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
}

@media (max-width: 768px) {
    .dashboard {
        padding: var(--space-16);
    }
    
    .header {
        flex-direction: column;
        gap: var(--space-16);
        text-align: center;
    }
    
    .header-content h1 {
        font-size: var(--font-size-3xl);
    }
    
    .charts-grid {
        grid-template-columns: 1fr;
    }
    
    .kpi-cards {
        grid-template-columns: 1fr;
    }
}
    </style>
</head>
<body>
    <div class="dashboard">
        <header class="header">
            <div class="header-content">
                <h1>Dashboard Resultados Acumulados 2025</h1>
                <p class="header-subtitle">MRS Log√≠stica | Janeiro a Setembro 2025 (4 Coordena√ß√µes: SP, MG, Horto, RJ)</p>
                <p class="header-date" id="currentDate"></p>
            </div>
            <div class="header-actions">
                <button class="btn-export" aria-label="Exportar relat√≥rio">üìä Exportar</button>
                <button class="theme-toggle" id="themeToggle" aria-label="Alternar tema">üåô Modo Escuro</button>
            </div>
        </header>

        <section class="kpi-cards">
            <div class="kpi-card">
                <div class="kpi-icon">üìä</div>
                <div class="kpi-value" id="totalNotas">35.682</div>
                <div class="kpi-label">Total de Notas</div>
            </div>
            <div class="kpi-card">
                <div class="kpi-icon">ü§ñ</div>
                <div class="kpi-value" id="totalGrc">27.645</div>
                <div class="kpi-label">Lan√ßamentos GRC (77,5%)</div>
            </div>
            <div class="kpi-card">
                <div class="kpi-icon">‚úçÔ∏è</div>
                <div class="kpi-value" id="totalManual">8.037</div>
                <div class="kpi-label">Lan√ßamentos Manual (22,5%)</div>
            </div>
            <div class="kpi-card">
                <div class="kpi-icon">üìÖ</div>
                <div class="kpi-value" id="entradasSetembro">3.355</div>
                <div class="kpi-label">Entradas Setembro</div>
            </div>
        </section>

        <section class="charts-grid">
            <!-- Chart 1: Distribui√ß√£o por Centros -->
            <div class="chart-card">
                <div class="chart-header">
                    <h2 class="chart-title">Distribui√ß√£o Total por Centros (Top 10)</h2>
                    <p class="chart-subtitle">GRC vs Manual por centro</p>
                </div>
                <div class="chart-container">
                    <canvas id="centrosChart"></canvas>
                </div>
            </div>

            <!-- Chart 2: Coordena√ß√µes GRC vs Manual -->
            <div class="chart-card">
                <div class="chart-header">
                    <h2 class="chart-title">Notas por Coordena√ß√£o - GRC vs Manual</h2>
                    <p class="chart-subtitle">Comparativo por √°rea (4 coordena√ß√µes)</p>
                </div>
                <div class="chart-container">
                    <canvas id="coordenacaoChart"></canvas>
                </div>
            </div>

            <!-- Chart 3: Entradas Mensais Total -->
            <div class="chart-card">
                <div class="chart-header">
                    <h2 class="chart-title">Evolu√ß√£o Mensal de Entradas - Total</h2>
                    <p class="chart-subtitle">Janeiro a Setembro 2025</p>
                </div>
                <div class="chart-container">
                    <canvas id="mensalChart"></canvas>
                </div>
            </div>

            <!-- Chart 4: Entradas Mensais GRC vs Manual -->
            <div class="chart-card">
                <div class="chart-header">
                    <h2 class="chart-title">Entradas Mensais - GRC vs Manual</h2>
                    <p class="chart-subtitle">Comparativo mensal de m√©todos de lan√ßamento</p>
                </div>
                <div class="chart-container">
                    <canvas id="mensalGrcManualChart"></canvas>
                </div>
            </div>

            <!-- Chart 5: Wabtec -->
            <div class="chart-card">
                <div class="chart-header">
                    <h2 class="chart-title">Wabtec: Lan√ßamentos GRC vs Manual</h2>
                    <p class="chart-subtitle">Total: 5.647 notas</p>
                </div>
                <div class="chart-container">
                    <canvas id="wabtecChart"></canvas>
                </div>
            </div>

            <!-- Chart 6: Setembro por Coordena√ß√£o -->
            <div class="chart-card">
                <div class="chart-header">
                    <h2 class="chart-title">Entradas em Setembro por Coordena√ß√£o</h2>
                    <p class="chart-subtitle">Total: 3.355 entradas (4 coordena√ß√µes)</p>
                </div>
                <div class="chart-container">
                    <canvas id="setembroChart"></canvas>
                </div>
            </div>
        </section>

        <footer class="footer">
            <div class="footer-info">
                <div><strong>Fonte:</strong> Resultados Acumulados_2025.xlsx</div>
                <div><strong>Observa√ß√£o:</strong> An√°lise realizada sem a coordena√ß√£o GIVS</div>
                <div><strong>√öltima atualiza√ß√£o:</strong> 28 de Outubro de 2025</div>
            </div>
            <div class="footer-brand">MRS Log√≠stica</div>
        </footer>
    </div>

    <script>
        // Theme toggle functionality
        const themeToggle = document.getElementById('themeToggle');
        const html = document.documentElement;
        
        // Check for saved theme preference or default to light mode
        let currentTheme = 'light';
        
        themeToggle.addEventListener('click', () => {
            currentTheme = currentTheme === 'light' ? 'dark' : 'light';
            html.setAttribute('data-color-scheme', currentTheme);
            themeToggle.textContent = currentTheme === 'light' ? 'üåô Modo Escuro' : '‚òÄÔ∏è Modo Claro';
            
            // Update all charts with new theme colors
            updateChartsTheme();
        });

        // Brazilian number formatting
        function formatNumber(num) {
            return num.toLocaleString('pt-BR');
        }

        function formatCurrency(num) {
            return num.toLocaleString('pt-BR', { style: 'currency', currency: 'BRL', minimumFractionDigits: 2 });
        }

        // Corporate color scheme for Power BI style
        const chartColors = {
            primary: ['#0078D4', '#106EBE', '#005A9E', '#004578', '#FF8C00', '#E67E00', '#CC7000', '#B36200'],
            coordenacao: ['#0078D4', '#106EBE', '#005A9E', '#004578'],
            grc: '#0078D4',
            manual: '#FF8C00',
            highlight: '#FF8C00',
            gradients: {
                blue: 'rgba(0, 120, 212, 0.2)',
                orange: 'rgba(255, 140, 0, 0.2)'
            }
        };

        // Display current date
        function displayCurrentDate() {
            const now = new Date();
            const options = { 
                weekday: 'long', 
                year: 'numeric', 
                month: 'long', 
                day: 'numeric',
                hour: '2-digit',
                minute: '2-digit'
            };
            document.getElementById('currentDate').textContent = now.toLocaleDateString('pt-BR', options);
        }
        
        displayCurrentDate();

        // Get current theme colors
        function getThemeColors() {
            const isDark = html.getAttribute('data-color-scheme') === 'dark';
            return {
                text: isDark ? 'rgba(245, 245, 245, 1)' : 'rgba(19, 52, 59, 1)',
                grid: isDark ? 'rgba(119, 124, 124, 0.2)' : 'rgba(94, 82, 64, 0.2)'
            };
        }

        let charts = {};

        // Chart 1: Distribui√ß√£o por Centros (Top 10)
        function createCentrosChart() {
            const ctx = document.getElementById('centrosChart').getContext('2d');
            const themeColors = getThemeColors();
            
            charts.centros = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: ['CEHF', 'CIPG', 'CFJC', 'CFBP', 'CIJN', 'CFCL', 'CFRT', 'CFEO', 'CFTA', 'CFPU'],
                    datasets: [
                        {
                            label: 'GRC',
                            data: [6862, 6663, 3943, 1971, 1314, 857, 836, 726, 935, 664],
                            backgroundColor: chartColors.grc,
                            borderRadius: 8,
                            borderWidth: 0
                        },
                        {
                            label: 'Manual',
                            data: [1560, 618, 826, 498, 517, 646, 503, 462, 52, 403],
                            backgroundColor: chartColors.manual,
                            borderRadius: 8,
                            borderWidth: 0
                        }
                    ]
                },
                options: {
                    indexAxis: 'y',
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'bottom',
                            labels: {
                                color: themeColors.text,
                                padding: 15,
                                font: { size: 13, weight: 500 }
                            }
                        },
                        tooltip: {
                            backgroundColor: 'rgba(0, 0, 0, 0.9)',
                            padding: 12,
                            titleFont: { size: 14, weight: 'bold' },
                            bodyFont: { size: 13 },
                            callbacks: {
                                label: function(context) {
                                    return context.dataset.label + ': ' + formatNumber(context.parsed.x);
                                },
                                footer: function(tooltipItems) {
                                    let total = 0;
                                    tooltipItems.forEach(item => {
                                        total += item.parsed.x;
                                    });
                                    return 'Total: ' + formatNumber(total);
                                }
                            }
                        }
                    },
                    scales: {
                        x: {
                            beginAtZero: true,
                            stacked: false,
                            ticks: {
                                color: themeColors.text,
                                callback: function(value) {
                                    return formatNumber(value);
                                }
                            },
                            grid: {
                                color: themeColors.grid
                            }
                        },
                        y: {
                            stacked: false,
                            ticks: {
                                color: themeColors.text,
                                font: { weight: 500, size: 11 }
                            },
                            grid: {
                                display: false
                            }
                        }
                    },
                    animation: {
                        duration: 1000,
                        easing: 'easeInOutQuart'
                    }
                }
            });
        }

        // Chart 2: Coordena√ß√µes GRC vs Manual
        function createCoordenacaoChart() {
            const ctx = document.getElementById('coordenacaoChart').getContext('2d');
            const themeColors = getThemeColors();
            
            charts.coordenacao = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: ['SP', 'MG', 'Horto', 'RJ'],
                    datasets: [
                        {
                            label: 'GRC',
                            data: [9727, 7267, 6341, 4310],
                            backgroundColor: chartColors.grc,
                            borderRadius: 8,
                            borderWidth: 0
                        },
                        {
                            label: 'Manual',
                            data: [2063, 2752, 1330, 1892],
                            backgroundColor: chartColors.manual,
                            borderRadius: 8,
                            borderWidth: 0
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'bottom',
                            labels: {
                                color: themeColors.text,
                                padding: 15,
                                font: { size: 13, weight: 500 }
                            }
                        },
                        tooltip: {
                            backgroundColor: 'rgba(0, 0, 0, 0.9)',
                            padding: 12,
                            titleFont: { size: 14, weight: 'bold' },
                            bodyFont: { size: 13 },
                            callbacks: {
                                label: function(context) {
                                    return context.dataset.label + ': ' + formatNumber(context.parsed.y);
                                },
                                footer: function(tooltipItems) {
                                    let total = 0;
                                    tooltipItems.forEach(item => {
                                        total += item.parsed.y;
                                    });
                                    const totalGeral = 35682;
                                    const percentage = ((total / totalGeral) * 100).toFixed(1);
                                    return 'Total: ' + formatNumber(total) + ' (' + percentage + '%)';
                                }
                            }
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            ticks: {
                                color: themeColors.text,
                                callback: function(value) {
                                    return formatNumber(value);
                                }
                            },
                            grid: {
                                color: themeColors.grid
                            }
                        },
                        x: {
                            ticks: {
                                color: themeColors.text,
                                font: { weight: 500 }
                            },
                            grid: {
                                display: false
                            }
                        }
                    },
                    animation: {
                        duration: 1000,
                        easing: 'easeInOutQuart'
                    }
                }
            });
        }

        // Chart 3: Entradas Mensais Total
        function createMensalChart() {
            const ctx = document.getElementById('mensalChart').getContext('2d');
            const themeColors = getThemeColors();
            
            charts.mensal = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: ['Jan', 'Fev', 'Mar', 'Abr', 'Mai', 'Jun', 'Jul', 'Ago', 'Set'],
                    datasets: [{
                        label: 'Entradas',
                        data: [4459, 3786, 3182, 4071, 3697, 3931, 5794, 3407, 3355],
                        borderColor: chartColors.grc,
                        backgroundColor: chartColors.gradients.blue,
                        borderWidth: 3,
                        fill: true,
                        tension: 0.4,
                        pointRadius: 6,
                        pointHoverRadius: 8,
                        pointBackgroundColor: function(context) {
                            const index = context.dataIndex;
                            return (index === 6 || index === 8) ? chartColors.highlight : chartColors.grc;
                        },
                        pointBorderWidth: 2,
                        pointBorderColor: '#fff',
                        segment: {
                            borderColor: function(context) {
                                const index = context.p0DataIndex;
                                return (index === 6) ? chartColors.highlight : chartColors.grc;
                            }
                        },
                        pointBorderColor: '#fff',
                        pointBorderWidth: 2
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: { display: false },
                        tooltip: {
                            backgroundColor: 'rgba(0, 0, 0, 0.9)',
                            padding: 12,
                            titleFont: { size: 14, weight: 'bold' },
                            bodyFont: { size: 13 },
                            displayColors: false,
                            callbacks: {
                                title: function(context) {
                                    const months = ['Janeiro', 'Fevereiro', 'Mar√ßo', 'Abril', 'Maio', 'Junho', 'Julho', 'Agosto', 'Setembro'];
                                    return months[context[0].dataIndex];
                                },
                                label: function(context) {
                                    return 'Entradas: ' + formatNumber(context.parsed.y);
                                }
                            }
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            ticks: {
                                color: themeColors.text,
                                callback: function(value) {
                                    return formatNumber(value);
                                }
                            },
                            grid: {
                                color: themeColors.grid
                            }
                        },
                        x: {
                            ticks: {
                                color: themeColors.text,
                                font: { weight: 500 }
                            },
                            grid: {
                                display: false
                            }
                        }
                    },
                    animation: {
                        duration: 1500,
                        easing: 'easeInOutQuart'
                    }
                }
            });
        }

        // Chart 4: Entradas Mensais GRC vs Manual
        function createMensalGrcManualChart() {
            const ctx = document.getElementById('mensalGrcManualChart').getContext('2d');
            const themeColors = getThemeColors();
            
            charts.mensalGrcManual = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: ['Jan', 'Fev', 'Mar', 'Abr', 'Mai', 'Jun', 'Jul', 'Ago', 'Set'],
                    datasets: [
                        {
                            label: 'GRC',
                            data: [3725, 2965, 2384, 3204, 2780, 3125, 4865, 2647, 1950],
                            backgroundColor: chartColors.grc,
                            borderRadius: 8,
                            borderWidth: 0
                        },
                        {
                            label: 'Manual',
                            data: [734, 821, 798, 867, 917, 806, 929, 760, 1405],
                            backgroundColor: chartColors.manual,
                            borderRadius: 8,
                            borderWidth: 0
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'bottom',
                            labels: {
                                color: themeColors.text,
                                padding: 15,
                                font: { size: 13, weight: 500 }
                            }
                        },
                        tooltip: {
                            backgroundColor: 'rgba(0, 0, 0, 0.9)',
                            padding: 12,
                            titleFont: { size: 14, weight: 'bold' },
                            bodyFont: { size: 13 },
                            callbacks: {
                                title: function(context) {
                                    const months = ['Janeiro', 'Fevereiro', 'Mar√ßo', 'Abril', 'Maio', 'Junho', 'Julho', 'Agosto', 'Setembro'];
                                    return months[context[0].dataIndex];
                                },
                                label: function(context) {
                                    return context.dataset.label + ': ' + formatNumber(context.parsed.y);
                                },
                                footer: function(tooltipItems) {
                                    let total = 0;
                                    tooltipItems.forEach(item => {
                                        total += item.parsed.y;
                                    });
                                    return 'Total: ' + formatNumber(total);
                                }
                            }
                        },
                        annotation: {
                            annotations: {
                                setembroHighlight: {
                                    type: 'box',
                                    xMin: 8,
                                    xMax: 8,
                                    backgroundColor: 'rgba(255, 140, 0, 0.1)',
                                    borderColor: chartColors.manual,
                                    borderWidth: 2
                                }
                            }
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            ticks: {
                                color: themeColors.text,
                                callback: function(value) {
                                    return formatNumber(value);
                                }
                            },
                            grid: {
                                color: themeColors.grid
                            }
                        },
                        x: {
                            ticks: {
                                color: themeColors.text,
                                font: { weight: 500 }
                            },
                            grid: {
                                display: false
                            }
                        }
                    },
                    animation: {
                        duration: 1000,
                        easing: 'easeInOutQuart'
                    }
                }
            });
        }

        // Chart 5: Wabtec
        function createWabtecChart() {
            const ctx = document.getElementById('wabtecChart').getContext('2d');
            const themeColors = getThemeColors();
            
            charts.wabtec = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: ['GRC', 'Manual'],
                    datasets: [{
                        label: 'Wabtec',
                        data: [5386, 261],
                        backgroundColor: [chartColors.grc, chartColors.manual],
                        borderRadius: 8,
                        borderWidth: 0
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: { display: false },
                        tooltip: {
                            backgroundColor: 'rgba(0, 0, 0, 0.9)',
                            padding: 12,
                            titleFont: { size: 14, weight: 'bold' },
                            bodyFont: { size: 13 },
                            displayColors: false,
                            callbacks: {
                                label: function(context) {
                                    const total = 5647;
                                    const percentage = ((context.parsed.y / total) * 100).toFixed(1);
                                    return context.label + ': ' + formatNumber(context.parsed.y) + ' (' + percentage + '%)';
                                }
                            }
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            ticks: {
                                color: themeColors.text,
                                callback: function(value) {
                                    return formatNumber(value);
                                }
                            },
                            grid: {
                                color: themeColors.grid
                            }
                        },
                        x: {
                            ticks: {
                                color: themeColors.text,
                                font: { weight: 500 }
                            },
                            grid: {
                                display: false
                            }
                        }
                    },
                    animation: {
                        duration: 1000,
                        easing: 'easeInOutQuart'
                    }
                }
            });
        }

        // Chart 6: Setembro por Coordena√ß√£o
        function createSetembroChart() {
            const ctx = document.getElementById('setembroChart').getContext('2d');
            const themeColors = getThemeColors();
            
            charts.setembro = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: ['MG', 'SP', 'RJ', 'Horto'],
                    datasets: [{
                        label: 'Entradas',
                        data: [1721, 962, 672, 426],
                        backgroundColor: [chartColors.coordenacao[1], chartColors.coordenacao[0], chartColors.coordenacao[3], chartColors.coordenacao[2]],
                        borderRadius: 8,
                        borderWidth: 0
                    }]
                },
                options: {
                    indexAxis: 'y',
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: { display: false },
                        tooltip: {
                            backgroundColor: 'rgba(0, 0, 0, 0.9)',
                            padding: 12,
                            titleFont: { size: 14, weight: 'bold' },
                            bodyFont: { size: 13 },
                            displayColors: false,
                            callbacks: {
                                label: function(context) {
                                    const total = 3355;
                                    const percentage = ((context.parsed.x / total) * 100).toFixed(1);
                                    return 'Entradas: ' + formatNumber(context.parsed.x) + ' (' + percentage + '%)';
                                }
                            }
                        }
                    },
                    scales: {
                        x: {
                            beginAtZero: true,
                            ticks: {
                                color: themeColors.text,
                                callback: function(value) {
                                    return formatNumber(value);
                                }
                            },
                            grid: {
                                color: themeColors.grid
                            }
                        },
                        y: {
                            ticks: {
                                color: themeColors.text,
                                font: { weight: 500 }
                            },
                            grid: {
                                display: false
                            }
                        }
                    },
                    animation: {
                        duration: 1000,
                        easing: 'easeInOutQuart'
                    }
                }
            });
        }

        // Update all charts with new theme
        function updateChartsTheme() {
            const themeColors = getThemeColors();
            
            Object.values(charts).forEach(chart => {
                // Update axis colors
                if (chart.options.scales) {
                    if (chart.options.scales.x) {
                        chart.options.scales.x.ticks.color = themeColors.text;
                        if (chart.options.scales.x.grid) {
                            chart.options.scales.x.grid.color = themeColors.grid;
                        }
                    }
                    if (chart.options.scales.y) {
                        chart.options.scales.y.ticks.color = themeColors.text;
                        if (chart.options.scales.y.grid) {
                            chart.options.scales.y.grid.color = themeColors.grid;
                        }
                    }
                }
                
                // Update legend colors
                if (chart.options.plugins.legend && chart.options.plugins.legend.labels) {
                    chart.options.plugins.legend.labels.color = themeColors.text;
                }
                
                chart.update('none'); // Update without animation
            });
        }

        // Initialize all charts when page loads
        window.addEventListener('load', () => {
            createCentrosChart();
            createCoordenacaoChart();
            createMensalChart();
            createMensalGrcManualChart();
            createWabtecChart();
            createSetembroChart();
        });
    </script>
</body>
</html>